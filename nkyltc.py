
def NKYLTC(TYP,DK1,TOPOIL,B,FREKV):

    ''' BER#KNING AV ANTAL KYLKANALER I TCA-K#RNAN '''

    TSLOPE=[[0.0124 , 0.0136 , 0.0124 , 0.0123 , 0.00713, 0.00781, 0.00825,0.00769],
           [0.0132 , 0.014  , 0.0125 , 0.0126 , 0.00763, 0.00819, 0.00838,0.00813],
           [0.0143 , 0.0144 , 0.0133 , 0.0133 , 0.00806, 0.00863, 0.00869,0.00825],
           [0.015  , 0.0152 , 0.014  , 0.0139 , 0.0085 , 0.00913, 0.00881,0.00856],
           [0.016  , 0.016  , 0.0156 , 0.0156 , 0.00906, 0.00956, 0.00913,0.00863],
           [0.0178 , 0.0174 , 0.0171 , 0.0169 , 0.00944, 0.00981, 0.0095 ,0.00913],
           [0.02   , 0.02   , 0.02   , 0.02   , 0.01   , 0.01   , 0.01   ,0.01   ]]

    TINTCP=[[-6.12, -7.28, -5.42, -5.32, -4.09, -4.62, -4.78, -4.23],
       [-6.46, -7.2 , -5.08, -5.13, -4.24, -4.58, -4.56, -4.34],
       [-6.82, -7.12, -5.27, -5.27, -4.34, -4.64, -4.48, -4.18],
       [-6.85, -7.16, -5.2 , -5.1 , -4.35, -4.69, -4.22, -4.19],
       [-7.  , -7.1 , -5.58, -5.58, -4.44, -4.59, -4.19, -3.94],
       [-7.49, -7.27, -5.66, -5.45, -4.16, -4.19, -4.05, -3.89],
       [-8.  , -8.  , -6.  , -6.  , -4.  , -4.  , -4.  , -4.  ]]

    BSLOPE=[[-0.082 , -0.0889, -0.132 , -0.174 , -0.104 , -0.116 , -0.139 ,-0.147 ],
       [-0.0595, -0.0641, -0.102 , -0.116 , -0.0909, -0.106 , -0.114 ,-0.128 ],
       [-0.05  , -0.0467, -0.0781, -0.0781, -0.0794, -0.0943, -0.0943,-0.105 ],
       [-0.0388, -0.0347, -0.0559, -0.0694, -0.0641, -0.0746, -0.0862,-0.0943],
       [ 0.    ,  0.    , -0.0427, -0.05  , -0.049 , -0.0685, -0.0769,-0.0877],
       [ 0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    , -0.0621,-0.0769],
       [ 0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    , -0.0538,-0.0676],
       [ 0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,-0.055 ],
       [ 0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,  0.    ,-0.0444]]

    BINTCP=[[ 2.07,  1.94,  2.07,  1.99,  2.13,  2.06,  2.15,  2.06],
       [ 2.21,  2.14,  2.31,  2.24,  2.27,  2.24,  2.3 ,  2.17],
       [ 2.33,  2.23,  2.41,  2.3 ,  2.38,  2.4 ,  2.35,  2.24],
       [ 2.34,  2.26,  2.39,  2.4 ,  2.4 ,  2.41,  2.41,  2.3 ],
       [10.  , 10.  ,  2.35,  2.35,  2.38,  2.48,  2.45,  2.38],
       [10.  , 10.  , 10.  , 10.  , 10.  , 10.  ,  2.43,  2.41],
       [10.  , 10.  , 10.  , 10.  , 10.  , 10.  ,  2.43,  2.42],
       [10.  , 10.  , 10.  , 10.  , 10.  , 10.  , 10.  ,  2.4 ],
       [10.  , 10.  , 10.  , 10.  , 10.  , 10.  , 10.  ,  2.36]]

    KCORE=[1,0,3,0,0,0,5,5,5,7]

    ''' write(*,*) '***nkyltc entry' '''

    DK=DK1*1000.
    NKYLTC=0
    ''' write(*,*) '***nkyltc typ ', typ '''
    KCOL=KCORE[TYP-1]
    ''' write(*,*) '***nkyltc kcol ', kcol '''

    if(FREKV > 55):
        KCOL=KCOL+1

    ''' write(*,*) '***nkyltc kcol ', kcol '''

    KTROW= int(.5+TOPOIL/5.)-11

    ''' write(*,*) '***nkyltc ktrow ', ktrow '''
    if(KTROW < 1 or KTROW > 7):
        if KTROW > 7:
            KTROW=7
        else:
            KTROW=1

    ''' write(*,*) '***nkyltc ktrow ', ktrow '''

    Y= TINTCP[KTROW-1][KCOL-1]+ TSLOPE[KTROW-1][KCOL-1]*DK

    ''' write(*,*) '***nkyltc y ', y '''
    for I in range(1,10):
        BCOMP= BINTCP[I-1][KCOL-1]+ BSLOPE[I-1][KCOL-1]*Y
        if(BCOMP < B):NKYLTC=I
 
    ''' write(*,*) '***nkyltc nkyltc ', nkyltc '''

    return NKYLTC
